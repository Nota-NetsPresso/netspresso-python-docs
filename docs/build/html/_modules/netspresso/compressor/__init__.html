<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>netspresso.compressor.__init__ &mdash; NetsPresso Python Package 0.1.0 documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
    <link rel="shortcut icon" href="../../../_static/netspresso_logo.png"/>
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/sphinx_highlight.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            NetsPresso Python Package
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Table of Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../quickstart.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../description.html">API Description</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">NetsPresso Python Package</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">netspresso.compressor.__init__</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for netspresso.compressor.__init__</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">wraps</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Union</span>

<span class="kn">from</span> <span class="nn">urllib</span> <span class="kn">import</span> <span class="n">request</span>
<span class="kn">from</span> <span class="nn">loguru</span> <span class="kn">import</span> <span class="n">logger</span>

<span class="kn">from</span> <span class="nn">netspresso.compressor.client</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">ModelCompressorAPIClient</span><span class="p">,</span>
    <span class="n">Task</span><span class="p">,</span>
    <span class="n">Framework</span><span class="p">,</span>
    <span class="n">CompressionMethod</span><span class="p">,</span>
    <span class="n">RecommendationMethod</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">netspresso.compressor.client.schemas.auth</span> <span class="kn">import</span> <span class="n">LoginRequest</span><span class="p">,</span> <span class="n">RefreshTokenRequest</span>
<span class="kn">from</span> <span class="nn">netspresso.compressor.client.schemas.model</span> <span class="kn">import</span> <span class="n">UploadModelRequest</span>
<span class="kn">from</span> <span class="nn">netspresso.compressor.client.schemas.compression</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">AutoCompressionRequest</span><span class="p">,</span>
    <span class="n">CompressionRequest</span><span class="p">,</span>
    <span class="n">GetAvailableLayersRequest</span><span class="p">,</span>
    <span class="n">CreateCompressionRequest</span><span class="p">,</span>
    <span class="n">RecommendationRequest</span><span class="p">,</span>
    <span class="n">UploadDatasetRequest</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">netspresso.compressor.core.model</span> <span class="kn">import</span> <span class="n">CompressedModel</span><span class="p">,</span> <span class="n">Model</span>
<span class="kn">from</span> <span class="nn">netspresso.compressor.core.compression</span> <span class="kn">import</span> <span class="n">CompressionBase</span><span class="p">,</span> <span class="n">CompressionInfo</span>
<span class="kn">from</span> <span class="nn">netspresso.compressor.utils.token</span> <span class="kn">import</span> <span class="n">check_jwt_exp</span>


<div class="viewcode-block" id="ModelCompressor"><a class="viewcode-back" href="../../../description/api.html#netspresso.compressor.__init__.ModelCompressor">[docs]</a><span class="k">class</span> <span class="nc">ModelCompressor</span><span class="p">:</span>
<div class="viewcode-block" id="ModelCompressor.__init__"><a class="viewcode-back" href="../../../description/api.html#netspresso.compressor.__init__.ModelCompressor.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">email</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">password</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the Model Compressor.</span>

<span class="sd">        Args:</span>
<span class="sd">            email (str): The email address for a user account.</span>
<span class="sd">            password (str): The password for a user account.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">email</span> <span class="o">=</span> <span class="n">email</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">password</span> <span class="o">=</span> <span class="n">password</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span> <span class="o">=</span> <span class="n">ModelCompressorAPIClient</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__login</span><span class="p">()</span></div>

    <span class="k">def</span> <span class="nf">__login</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">LoginRequest</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">email</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">password</span><span class="p">)</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">access_token</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">access_token</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">refresh_token</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">refresh_token</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Login successful&quot;</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Login failed. Error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">e</span>

    <span class="k">def</span> <span class="nf">validate_token</span><span class="p">(</span><span class="n">func</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nd">@wraps</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">check_jwt_exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">access_token</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__reissue_token</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">wrapper</span>

    <span class="k">def</span> <span class="nf">__reissue_token</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">RefreshTokenRequest</span><span class="p">(</span><span class="n">access_token</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">access_token</span><span class="p">,</span> <span class="n">refresh_token</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">refresh_token</span><span class="p">)</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">refresh_token</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">access_token</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">access_token</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">refresh_token</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">refresh_token</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">e</span>

<div class="viewcode-block" id="ModelCompressor.get_credit"><a class="viewcode-back" href="../../../description/api.html#netspresso.compressor.__init__.ModelCompressor.get_credit">[docs]</a>    <span class="nd">@validate_token</span>
    <span class="k">def</span> <span class="nf">get_credit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the available NetsPresso credits.</span>

<span class="sd">        Raises:</span>
<span class="sd">            e: If an error occurs while getting credit information.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: The total amount of available NetsPresso credits.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">credit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_credit</span><span class="p">(</span><span class="n">access_token</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">access_token</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Get Credit successful. Credit: </span><span class="si">{</span><span class="n">credit</span><span class="o">.</span><span class="n">total</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">credit</span><span class="o">.</span><span class="n">total</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Get Credit failed. Error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">e</span></div>

<div class="viewcode-block" id="ModelCompressor.upload_model"><a class="viewcode-back" href="../../../description/api.html#netspresso.compressor.__init__.ModelCompressor.upload_model">[docs]</a>    <span class="nd">@validate_token</span>
    <span class="k">def</span> <span class="nf">upload_model</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">model_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">task</span><span class="p">:</span> <span class="n">Task</span><span class="p">,</span> <span class="n">framework</span><span class="p">:</span> <span class="n">Framework</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">input_shapes</span><span class="p">:</span> <span class="n">List</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Model</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Upload a model for compression.</span>

<span class="sd">        Args:</span>
<span class="sd">            model_name (str): The name of the model.</span>
<span class="sd">            task (Task): The task of the model.</span>
<span class="sd">            framework (Framework): The framework of the model.</span>
<span class="sd">            file_path (str): The file path where the model is located.</span>
<span class="sd">            input_shapes (List[str], optional): Input shapes of the model. Defaults to [].</span>

<span class="sd">        Note:</span>
<span class="sd">            * Currently, only single input models are supported.</span>
<span class="sd">            * If the model&#39;s `input_shapes` are **dynamic**, it must be provided as a required input.</span>
<span class="sd">            * If the model&#39;s `input_shapes` are **static**, it must be set to the same shape as the model&#39;s input tensor.</span>

<span class="sd">        Raises:</span>
<span class="sd">            e: If an error occurs while uploading the model.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Model: Uploaded model object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Uploading Model...&quot;</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">UploadModelRequest</span><span class="p">(</span>
                <span class="n">model_name</span><span class="o">=</span><span class="n">model_name</span><span class="p">,</span>
                <span class="n">task</span><span class="o">=</span><span class="n">task</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                <span class="n">framework</span><span class="o">=</span><span class="n">framework</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                <span class="n">file_path</span><span class="o">=</span><span class="n">file_path</span><span class="p">,</span>
                <span class="n">input_layers</span><span class="o">=</span><span class="n">input_shapes</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">model_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">upload_model</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">access_token</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">access_token</span><span class="p">)</span>
            <span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">model_info</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Upload model successful. Model ID: </span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">model_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">model</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Upload model failed. Error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">e</span></div>

<div class="viewcode-block" id="ModelCompressor.get_models"><a class="viewcode-back" href="../../../description/api.html#netspresso.compressor.__init__.ModelCompressor.get_models">[docs]</a>    <span class="nd">@validate_token</span>
    <span class="k">def</span> <span class="nf">get_models</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the list of uploaded &amp; compressed models.</span>

<span class="sd">        Raises:</span>
<span class="sd">            e: If an error occurs while getting the model list.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List[Dict[str, Any]]: The list of uploaded &amp; compressed models.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Getting model list...&quot;</span><span class="p">)</span>
            <span class="n">models</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">parent_models</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_parent_models</span><span class="p">(</span><span class="n">is_simple</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">access_token</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">access_token</span><span class="p">)</span>
            <span class="n">uploaded_models</span> <span class="o">=</span> <span class="p">[</span>
                <span class="nb">vars</span><span class="p">(</span><span class="n">Model</span><span class="p">(</span><span class="n">parent_model</span><span class="p">))</span> <span class="k">for</span> <span class="n">parent_model</span> <span class="ow">in</span> <span class="n">parent_models</span> <span class="k">if</span> <span class="n">parent_model</span><span class="o">.</span><span class="n">origin_from</span> <span class="o">==</span> <span class="s2">&quot;custom&quot;</span>
            <span class="p">]</span>
            <span class="k">for</span> <span class="n">uploaded_model</span> <span class="ow">in</span> <span class="n">uploaded_models</span><span class="p">:</span>
                <span class="n">children_models</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_children_models</span><span class="p">(</span>
                    <span class="n">model_id</span><span class="o">=</span><span class="n">uploaded_model</span><span class="p">[</span><span class="s2">&quot;model_id&quot;</span><span class="p">],</span> <span class="n">access_token</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">access_token</span>
                <span class="p">)</span>
                <span class="n">uploaded_model</span><span class="p">[</span><span class="s2">&quot;compressed_models&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="nb">vars</span><span class="p">(</span><span class="n">CompressedModel</span><span class="p">(</span><span class="n">children_model</span><span class="p">))</span> <span class="k">for</span> <span class="n">children_model</span> <span class="ow">in</span> <span class="n">children_models</span>
                <span class="p">]</span>
                <span class="n">models</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">uploaded_model</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Get model list successful.&quot;</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">models</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Get model list failed. Error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">e</span></div>

<div class="viewcode-block" id="ModelCompressor.get_uploaded_models"><a class="viewcode-back" href="../../../description/api.html#netspresso.compressor.__init__.ModelCompressor.get_uploaded_models">[docs]</a>    <span class="nd">@validate_token</span>
    <span class="k">def</span> <span class="nf">get_uploaded_models</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the list of uploaded models.</span>

<span class="sd">        Raises:</span>
<span class="sd">            e: If an error occurs while getting the uploaded model list.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List[Dict[str, Any]]: The list of uploaded models.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Getting uploaded model list...&quot;</span><span class="p">)</span>
            <span class="n">parent_models</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_parent_models</span><span class="p">(</span><span class="n">is_simple</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">access_token</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">access_token</span><span class="p">)</span>
            <span class="n">uploaded_models</span> <span class="o">=</span> <span class="p">[</span>
                <span class="nb">vars</span><span class="p">(</span><span class="n">Model</span><span class="p">(</span><span class="n">parent_model</span><span class="p">))</span> <span class="k">for</span> <span class="n">parent_model</span> <span class="ow">in</span> <span class="n">parent_models</span> <span class="k">if</span> <span class="n">parent_model</span><span class="o">.</span><span class="n">origin_from</span> <span class="o">==</span> <span class="s2">&quot;custom&quot;</span>
            <span class="p">]</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Get uploaded model list successful.&quot;</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">uploaded_models</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Get uploaded model list failed. Error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">e</span></div>

<div class="viewcode-block" id="ModelCompressor.get_compressed_models"><a class="viewcode-back" href="../../../description/api.html#netspresso.compressor.__init__.ModelCompressor.get_compressed_models">[docs]</a>    <span class="nd">@validate_token</span>
    <span class="k">def</span> <span class="nf">get_compressed_models</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the list of compressed models for a given model ID.</span>

<span class="sd">        Args:</span>
<span class="sd">            model_id (str): The ID of the model.</span>

<span class="sd">        Raises:</span>
<span class="sd">            e: If an error occurs while getting the compressed model list.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List[Dict[str, Any]]: The list of compressed models for a given model ID.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Getting compressed model list...&quot;</span><span class="p">)</span>
            <span class="n">children_models</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_children_models</span><span class="p">(</span><span class="n">model_id</span><span class="o">=</span><span class="n">model_id</span><span class="p">,</span> <span class="n">access_token</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">access_token</span><span class="p">)</span>
            <span class="n">compressed_models</span> <span class="o">=</span> <span class="p">[</span><span class="nb">vars</span><span class="p">(</span><span class="n">CompressedModel</span><span class="p">(</span><span class="n">children_model</span><span class="p">))</span> <span class="k">for</span> <span class="n">children_model</span> <span class="ow">in</span> <span class="n">children_models</span><span class="p">]</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Get compressed model list successful.&quot;</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">compressed_models</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Get compressed model list failed. Error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">e</span></div>

<div class="viewcode-block" id="ModelCompressor.get_model"><a class="viewcode-back" href="../../../description/api.html#netspresso.compressor.__init__.ModelCompressor.get_model">[docs]</a>    <span class="nd">@validate_token</span>
    <span class="k">def</span> <span class="nf">get_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">Model</span><span class="p">,</span> <span class="n">CompressedModel</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the model for a given model ID.</span>

<span class="sd">        Args:</span>
<span class="sd">            model_id (str): The ID of the model.</span>

<span class="sd">        Raises:</span>
<span class="sd">            e: If an error occurs while getting the model.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Union[Model, CompressedModel]: The retrieved model. If the model is compressed,</span>
<span class="sd">            `CompressedModel` will be returned. Otherwise, `Model` will be returned.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Getting model...&quot;</span><span class="p">)</span>
            <span class="n">model_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_model_info</span><span class="p">(</span><span class="n">model_id</span><span class="o">=</span><span class="n">model_id</span><span class="p">,</span> <span class="n">access_token</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">access_token</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">model_info</span><span class="o">.</span><span class="n">status</span><span class="o">.</span><span class="n">is_compressed</span><span class="p">:</span>
                <span class="n">model</span> <span class="o">=</span> <span class="n">CompressedModel</span><span class="p">(</span><span class="n">model_info</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">model_info</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Get model successful.&quot;</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">model</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Get model failed. Error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">e</span></div>

<div class="viewcode-block" id="ModelCompressor.download_model"><a class="viewcode-back" href="../../../description/api.html#netspresso.compressor.__init__.ModelCompressor.download_model">[docs]</a>    <span class="nd">@validate_token</span>
    <span class="k">def</span> <span class="nf">download_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">local_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Download the model for a given model ID to the local path.</span>

<span class="sd">        Args:</span>
<span class="sd">            model_id (str): The ID of the model.</span>
<span class="sd">            local_path (str): The local path to save the downloaded model.</span>

<span class="sd">        Raises:</span>
<span class="sd">            e: If an error occurs while downloading the model.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Downloading model...&quot;</span><span class="p">)</span>
            <span class="n">download_link</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_download_model_link</span><span class="p">(</span><span class="n">model_id</span><span class="o">=</span><span class="n">model_id</span><span class="p">,</span> <span class="n">access_token</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">access_token</span><span class="p">)</span>
            <span class="n">request</span><span class="o">.</span><span class="n">urlretrieve</span><span class="p">(</span><span class="n">download_link</span><span class="o">.</span><span class="n">url</span><span class="p">,</span> <span class="n">local_path</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Download model successful. Local Path: </span><span class="si">{</span><span class="n">local_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Download model failed. Error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">e</span></div>

<div class="viewcode-block" id="ModelCompressor.delete_model"><a class="viewcode-back" href="../../../description/api.html#netspresso.compressor.__init__.ModelCompressor.delete_model">[docs]</a>    <span class="nd">@validate_token</span>
    <span class="k">def</span> <span class="nf">delete_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">recursive</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Delete the model for a given model ID.</span>

<span class="sd">        Args:</span>
<span class="sd">            model_id (str): The ID of the model.</span>
<span class="sd">            recursive (bool, optional): Whether to also delete the compressed model for that model. Defaults to False.</span>

<span class="sd">        Raises:</span>
<span class="sd">            e: If an error occurs while deleting the model.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Deleting model...&quot;</span><span class="p">)</span>
            <span class="n">children_models</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_children_models</span><span class="p">(</span><span class="n">model_id</span><span class="o">=</span><span class="n">model_id</span><span class="p">,</span> <span class="n">access_token</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">access_token</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">children_models</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">recursive</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                        <span class="s2">&quot;Deleting the model will also delete its compressed models. To proceed with the deletion, set the `recursive` parameter to True.&quot;</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;The compressed model for that model will also be deleted.&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">delete_model</span><span class="p">(</span><span class="n">model_id</span><span class="o">=</span><span class="n">model_id</span><span class="p">,</span> <span class="n">access_token</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">access_token</span><span class="p">)</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Delete model successful.&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;The model will be deleted.&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">delete_model</span><span class="p">(</span><span class="n">model_id</span><span class="o">=</span><span class="n">model_id</span><span class="p">,</span> <span class="n">access_token</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">access_token</span><span class="p">)</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Delete model successful.&quot;</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Delete model failed. Error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">e</span></div>

<div class="viewcode-block" id="ModelCompressor.select_compression_method"><a class="viewcode-back" href="../../../description/api.html#netspresso.compressor.__init__.ModelCompressor.select_compression_method">[docs]</a>    <span class="nd">@validate_token</span>
    <span class="k">def</span> <span class="nf">select_compression_method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">compression_method</span><span class="p">:</span> <span class="n">CompressionMethod</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CompressionBase</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Select a compression method for a model.</span>

<span class="sd">        Args:</span>
<span class="sd">            model_id (str): The ID of the model.</span>
<span class="sd">            compression_method (CompressionMethod): The selected compression method.</span>

<span class="sd">        Raises:</span>
<span class="sd">            e: If an error occurs while selecting the compression method.</span>

<span class="sd">        Returns:</span>
<span class="sd">            CompressionBase: The compression information for the selected compression method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Selecting compression method...&quot;</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">GetAvailableLayersRequest</span><span class="p">(</span><span class="n">model_id</span><span class="o">=</span><span class="n">model_id</span><span class="p">,</span> <span class="n">compression_method</span><span class="o">=</span><span class="n">compression_method</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_available_layers</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">access_token</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">access_token</span><span class="p">)</span>
            <span class="n">compression_info</span> <span class="o">=</span> <span class="n">CompressionBase</span><span class="p">(</span><span class="n">compression_method</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">available_layers</span><span class="p">,</span> <span class="n">model_id</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Select compression method successful.&quot;</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">compression_info</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Select compression method failed. Error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">e</span></div>

<div class="viewcode-block" id="ModelCompressor.get_compression"><a class="viewcode-back" href="../../../description/api.html#netspresso.compressor.__init__.ModelCompressor.get_compression">[docs]</a>    <span class="nd">@validate_token</span>
    <span class="k">def</span> <span class="nf">get_compression</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">compression_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CompressionInfo</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get information about a compression.</span>

<span class="sd">        Args:</span>
<span class="sd">            compression_id (str): The ID of the compression.</span>

<span class="sd">        Raises:</span>
<span class="sd">            e: If an error occurs while getting the compression information.</span>

<span class="sd">        Returns:</span>
<span class="sd">            CompressionInfo: The information about the compression.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Getting compression...&quot;</span><span class="p">)</span>
            <span class="n">compression_info</span> <span class="o">=</span> <span class="n">CompressionInfo</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_compression_info</span><span class="p">(</span><span class="n">compression_id</span><span class="o">=</span><span class="n">compression_id</span><span class="p">,</span> <span class="n">access_token</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">access_token</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Get compression successful.&quot;</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">compression_info</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Get compression failed. Error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">e</span></div>

    <span class="nd">@validate_token</span>
    <span class="k">def</span> <span class="nf">__upload_dataset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">dataset_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Upload a dataset for nuclear norm compression method.</span>

<span class="sd">        Args:</span>
<span class="sd">            model_id (str): The ID of the model.</span>
<span class="sd">            dataset_path (str): The file path where the dataset is located.</span>

<span class="sd">        Raises:</span>
<span class="sd">            e: If an error occurs while uploading the dataset.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Uploading dataset...&quot;</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">UploadDatasetRequest</span><span class="p">(</span><span class="n">model_id</span><span class="o">=</span><span class="n">model_id</span><span class="p">,</span> <span class="n">file_path</span><span class="o">=</span><span class="n">dataset_path</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">upload_dataset</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">access_token</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">access_token</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Upload dataset successful.&quot;</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Upload dataset failed. Error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">e</span>

<div class="viewcode-block" id="ModelCompressor.compress_model"><a class="viewcode-back" href="../../../description/api.html#netspresso.compressor.__init__.ModelCompressor.compress_model">[docs]</a>    <span class="nd">@validate_token</span>
    <span class="k">def</span> <span class="nf">compress_model</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">compression</span><span class="p">:</span> <span class="n">CompressionInfo</span><span class="p">,</span> <span class="n">model_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">output_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">dataset_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CompressedModel</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compress a model using the provided compression information.</span>

<span class="sd">        Args:</span>
<span class="sd">            compression (CompressionInfo): The information about the compression.</span>
<span class="sd">            model_name (str): The name of the compressed model.</span>
<span class="sd">            output_path (str): The local path to save the compressed model.</span>
<span class="sd">            dataset_path (str, optional): The path of the dataset used for nuclear norm compression method. Default is None.</span>

<span class="sd">        Raises:</span>
<span class="sd">            e: If an error occurs while compressing the model.</span>

<span class="sd">        Returns:</span>
<span class="sd">            CompressedModel: The compressed model.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Compressing model...&quot;</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">CreateCompressionRequest</span><span class="p">(</span>
                <span class="n">model_id</span><span class="o">=</span><span class="n">compression</span><span class="o">.</span><span class="n">model_id</span><span class="p">,</span>
                <span class="n">model_name</span><span class="o">=</span><span class="n">model_name</span><span class="p">,</span>
                <span class="n">compression_method</span><span class="o">=</span><span class="n">compression</span><span class="o">.</span><span class="n">compression_method</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">compression_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">create_compression</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">access_token</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">access_token</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">dataset_path</span> <span class="ow">and</span> <span class="n">compression</span><span class="o">.</span><span class="n">compression_method</span> <span class="o">==</span> <span class="n">CompressionMethod</span><span class="o">.</span><span class="n">PR_NN</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__upload_dataset</span><span class="p">(</span><span class="n">model_id</span><span class="o">=</span><span class="n">compression</span><span class="o">.</span><span class="n">model_id</span><span class="p">,</span> <span class="n">dataset_path</span><span class="o">=</span><span class="n">dataset_path</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">available_layers</span> <span class="ow">in</span> <span class="n">compression</span><span class="o">.</span><span class="n">available_layers</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">available_layers</span><span class="o">.</span><span class="n">values</span> <span class="o">!=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">]:</span>
                    <span class="n">available_layers</span><span class="o">.</span><span class="n">use</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">CompressionRequest</span><span class="p">(</span>
                <span class="n">compression_id</span><span class="o">=</span><span class="n">compression_info</span><span class="o">.</span><span class="n">compression_id</span><span class="p">,</span>
                <span class="n">compression_method</span><span class="o">=</span><span class="n">compression</span><span class="o">.</span><span class="n">compression_method</span><span class="p">,</span>
                <span class="n">layers</span><span class="o">=</span><span class="n">compression</span><span class="o">.</span><span class="n">available_layers</span><span class="p">,</span>
                <span class="n">compressed_model_id</span><span class="o">=</span><span class="n">compression_info</span><span class="o">.</span><span class="n">new_model_id</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">compress_model</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">access_token</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">access_token</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">download_model</span><span class="p">(</span><span class="n">model_id</span><span class="o">=</span><span class="n">compression_info</span><span class="o">.</span><span class="n">new_model_id</span><span class="p">,</span> <span class="n">local_path</span><span class="o">=</span><span class="n">output_path</span><span class="p">)</span>
            <span class="n">compressed_model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_model</span><span class="p">(</span><span class="n">model_id</span><span class="o">=</span><span class="n">compression_info</span><span class="o">.</span><span class="n">new_model_id</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Compress model successful. Compressed Model ID: </span><span class="si">{</span><span class="n">compressed_model</span><span class="o">.</span><span class="n">model_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;50 credits have been consumed.&quot;</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">compressed_model</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Compress model failed. Error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">e</span></div>

<div class="viewcode-block" id="ModelCompressor.recommendation_compression"><a class="viewcode-back" href="../../../description/api.html#netspresso.compressor.__init__.ModelCompressor.recommendation_compression">[docs]</a>    <span class="nd">@validate_token</span>
    <span class="k">def</span> <span class="nf">recommendation_compression</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">model_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">model_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">compression_method</span><span class="p">:</span> <span class="n">CompressionMethod</span><span class="p">,</span>
        <span class="n">recommendation_method</span><span class="p">:</span> <span class="n">RecommendationMethod</span><span class="p">,</span>
        <span class="n">recommendation_ratio</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">output_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">dataset_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CompressedModel</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compress a recommendation-based model using the given compression and recommendation methods.</span>

<span class="sd">        Args:</span>
<span class="sd">            model_id (str): The ID of the model.</span>
<span class="sd">            model_name (str): The name of the compressed model.</span>
<span class="sd">            compression_method (CompressionMethod): The selected compression method.</span>
<span class="sd">            recommendation_method (RecommendationMethod): The selected recommendation method.</span>
<span class="sd">            recommendation_ratio (float): The compression ratio recommended by the recommendation method.</span>
<span class="sd">            output_path (str): The local path to save the compressed model.</span>
<span class="sd">            dataset_path (str, optional): The path of the dataset used for nuclear norm compression method. Default is None.</span>

<span class="sd">        Note:</span>
<span class="sd">            - recommendation_method</span>
<span class="sd">                - If you selected PR_L2, PR_GM, PR_NN for compression_method</span>
<span class="sd">                    - The recommended_method available is **SLAMP**.</span>
<span class="sd">                - If you selected FD_TK, FD_SVD for compression_method</span>
<span class="sd">                    - The recommended_method available is **VBMF**.</span>
<span class="sd">            - recommendation_ratio:</span>
<span class="sd">                - SLAMP: 0 &lt; ratio &lt;= 1</span>
<span class="sd">                - VBMF: -1 &lt;= ratio &lt;= 1</span>

<span class="sd">        Raises:</span>
<span class="sd">            e: If an error occurs while performing recommendation compression.</span>

<span class="sd">        Returns:</span>
<span class="sd">            CompressedModel: The compressed model.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Compressing recommendation-based model...&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="p">(</span>
                <span class="n">compression_method</span> <span class="ow">in</span> <span class="p">[</span><span class="n">CompressionMethod</span><span class="o">.</span><span class="n">PR_L2</span><span class="p">,</span> <span class="n">CompressionMethod</span><span class="o">.</span><span class="n">PR_GM</span><span class="p">,</span> <span class="n">CompressionMethod</span><span class="o">.</span><span class="n">PR_NN</span><span class="p">]</span>
                <span class="ow">and</span> <span class="n">recommendation_method</span> <span class="o">!=</span> <span class="n">RecommendationMethod</span><span class="o">.</span><span class="n">SLAMP</span>
            <span class="p">):</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;The </span><span class="si">{</span><span class="n">compression_method</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2"> compression method is only available the SLAMP recommendation method.&quot;</span>
                <span class="p">)</span>

            <span class="k">if</span> <span class="p">(</span>
                <span class="n">compression_method</span> <span class="ow">in</span> <span class="p">[</span><span class="n">CompressionMethod</span><span class="o">.</span><span class="n">FD_TK</span><span class="p">,</span> <span class="n">CompressionMethod</span><span class="o">.</span><span class="n">FD_SVD</span><span class="p">]</span>
                <span class="ow">and</span> <span class="n">recommendation_method</span> <span class="o">!=</span> <span class="n">RecommendationMethod</span><span class="o">.</span><span class="n">VBMF</span>
            <span class="p">):</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;The </span><span class="si">{</span><span class="n">compression_method</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2"> compression method is only available the VBMF recommendation method.&quot;</span>
                <span class="p">)</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">CreateCompressionRequest</span><span class="p">(</span>
                <span class="n">model_id</span><span class="o">=</span><span class="n">model_id</span><span class="p">,</span>
                <span class="n">model_name</span><span class="o">=</span><span class="n">model_name</span><span class="p">,</span>
                <span class="n">compression_method</span><span class="o">=</span><span class="n">compression_method</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">compression_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">create_compression</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">access_token</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">access_token</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">dataset_path</span> <span class="ow">and</span> <span class="n">compression_method</span> <span class="o">==</span> <span class="n">CompressionMethod</span><span class="o">.</span><span class="n">PR_NN</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__upload_dataset</span><span class="p">(</span><span class="n">model_id</span><span class="o">=</span><span class="n">model_id</span><span class="p">,</span> <span class="n">dataset_path</span><span class="o">=</span><span class="n">dataset_path</span><span class="p">)</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">RecommendationRequest</span><span class="p">(</span>
                <span class="n">model_id</span><span class="o">=</span><span class="n">model_id</span><span class="p">,</span>
                <span class="n">compression_id</span><span class="o">=</span><span class="n">compression_info</span><span class="o">.</span><span class="n">compression_id</span><span class="p">,</span>
                <span class="n">recommendation_method</span><span class="o">=</span><span class="n">recommendation_method</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                <span class="n">recommendation_ratio</span><span class="o">=</span><span class="n">recommendation_ratio</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">recommendation_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_recommendation</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">access_token</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">access_token</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">available_layer</span><span class="p">,</span> <span class="n">recommended_info</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
                <span class="n">compression_info</span><span class="o">.</span><span class="n">available_layers</span><span class="p">,</span> <span class="n">recommendation_result</span><span class="o">.</span><span class="n">recommended_layers</span>
            <span class="p">):</span>
                <span class="n">available_layer</span><span class="o">.</span><span class="n">use</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">available_layer</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="n">recommended_info</span><span class="o">.</span><span class="n">values</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">CompressionRequest</span><span class="p">(</span>
                <span class="n">compression_id</span><span class="o">=</span><span class="n">compression_info</span><span class="o">.</span><span class="n">compression_id</span><span class="p">,</span>
                <span class="n">compression_method</span><span class="o">=</span><span class="n">compression_method</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                <span class="n">layers</span><span class="o">=</span><span class="n">compression_info</span><span class="o">.</span><span class="n">available_layers</span><span class="p">,</span>
                <span class="n">compressed_model_id</span><span class="o">=</span><span class="n">compression_info</span><span class="o">.</span><span class="n">new_model_id</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">compress_model</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">access_token</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">access_token</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">download_model</span><span class="p">(</span><span class="n">model_id</span><span class="o">=</span><span class="n">compression_info</span><span class="o">.</span><span class="n">new_model_id</span><span class="p">,</span> <span class="n">local_path</span><span class="o">=</span><span class="n">output_path</span><span class="p">)</span>
            <span class="n">compressed_model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_model</span><span class="p">(</span><span class="n">model_id</span><span class="o">=</span><span class="n">compression_info</span><span class="o">.</span><span class="n">new_model_id</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Recommendation compression successful. Compressed Model ID: </span><span class="si">{</span><span class="n">compressed_model</span><span class="o">.</span><span class="n">model_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;50 credits have been consumed.&quot;</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">compressed_model</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Recommendation compression failed. Error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">e</span></div>

<div class="viewcode-block" id="ModelCompressor.automatic_compression"><a class="viewcode-back" href="../../../description/api.html#netspresso.compressor.__init__.ModelCompressor.automatic_compression">[docs]</a>    <span class="nd">@validate_token</span>
    <span class="k">def</span> <span class="nf">automatic_compression</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">model_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">model_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">output_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">compression_ratio</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CompressedModel</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compress a model automatically based on the given compression ratio.</span>

<span class="sd">        Args:</span>
<span class="sd">            model_id (str): The ID of the model.</span>
<span class="sd">            model_name (str): The name of the compressed model.</span>
<span class="sd">            output_path (str): The local path to save the compressed model.</span>
<span class="sd">            compression_ratio (float): The compression ratio for automatic compression. Defaults to 0.5.</span>

<span class="sd">        Note:</span>
<span class="sd">            - compression_ratio: 0 &lt; ratio &lt;= 1</span>

<span class="sd">        Raises:</span>
<span class="sd">            e: If an error occurs while performing automatic compression.</span>

<span class="sd">        Returns:</span>
<span class="sd">            CompressedModel: The compressed model.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Compressing automatic-based model...&quot;</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">AutoCompressionRequest</span><span class="p">(</span>
                <span class="n">model_id</span><span class="o">=</span><span class="n">model_id</span><span class="p">,</span>
                <span class="n">model_name</span><span class="o">=</span><span class="n">model_name</span><span class="p">,</span>
                <span class="n">recommendation_ratio</span><span class="o">=</span><span class="n">compression_ratio</span><span class="p">,</span>
                <span class="n">save_path</span><span class="o">=</span><span class="n">output_path</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">model_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">auto_compression</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">access_token</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">access_token</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">download_model</span><span class="p">(</span><span class="n">model_id</span><span class="o">=</span><span class="n">model_info</span><span class="o">.</span><span class="n">model_id</span><span class="p">,</span> <span class="n">local_path</span><span class="o">=</span><span class="n">output_path</span><span class="p">)</span>
            <span class="n">compressed_model</span> <span class="o">=</span> <span class="n">CompressedModel</span><span class="p">(</span><span class="n">model_info</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Automatic compression successful. Compressed Model ID: </span><span class="si">{</span><span class="n">compressed_model</span><span class="o">.</span><span class="n">model_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;25 credits have been consumed.&quot;</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">compressed_model</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Automatic compression failed. Error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">e</span></div></div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Nota AI.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>